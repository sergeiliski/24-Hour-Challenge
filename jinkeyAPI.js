(function(e,t){var n="24 Challenge version 2014 Winter",r=window.jinkeyAPI,i=window.document,s=window.location,o=true;jinkeyAPI=function(e){return new jinkeyAPI.pr.init(e)};var u={active:true,calls:0,calledBySelector:0};jinkeyAPI.pr=jinkeyAPI.prototype={jinkey:n,constructor:jinkeyAPI,selector:"",init:function(e){if(!e)return this;this.selector=e;if(u.active){u.calledBySelector++}},prevent:function(e){if(e){o=true}else{o=false}}};jinkeyAPI.pr.init.prototype=jinkeyAPI.pr;jinkeyAPI.input=jinkeyAPI.prototype;keysPressed={},jinkeyAPI.input.isDown=function(e){if(keysPressed[this.selector]){return e()}};jinkeyAPI.input.isUp=function(e){if(!keysPressed[this.selector]){return e()}};jinkeyAPI.keys={BACKSPACE:8,TAB:9,SPACE:32,LEFT:37,RIGHT:39,DOWN:40,UP:38,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,ESCAPE:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INSERT:45,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,MOD_WIN:91,MENU:93,KP_0:96,KP_1:97,KP_2:98,KP_3:99,KP_4:100,KP_5:101,KP_6:102,KP_7:103,KP_8:104,KP_9:105,KP_MULTIPLY:106,KP_PLUS:107,KP_MINUS:109,KP_DECIMAL:110,SLASH:111,DECIMAL:188,PERIOD:190,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,CAPS_LOCK:20,NUM_LOCK:144,SCROLL_LOCK:145,LEFT_BRACKET:219,BACKSLASH:220,RIGHT_BRACKET:221},jinkeyAPI.input.mouse={xcoord:0,ycoord:0};jinkeyAPI.input.listen=function(){i.addEventListener("keydown",function(e){e.preventDefault();keysPressed[e.keyCode]=true});i.addEventListener("keyup",function(e){e.preventDefault();keysPressed[e.keyCode]=false});i.addEventListener("blur",function(e){keysPressed={}});window.addEventListener("mousemove",function(e){e.preventDefault();jinkeyAPI.input.mouse.xcoord=e.clientX;jinkeyAPI.input.mouse.ycoord=e.clienty});return"listening"};jinkeyAPI.CartesianCoord=function(e,t,n){this.xcoord=e;this.ycoord=t;this.zcoord=n};jinkeyAPI.CartesianCoord.prototype={constructor:jinkeyAPI.CartesianCoord,zero:function(){this.xcoord=0;this.ycoord=0;this.zcoord=0},set:function(e,t,n){this.xcoord=e;this.ycoord=t;this.zcoord=n},add:function(e){this.xcoord+=e.xcoord;this.ycoord+=e.ycoord;this.zcoord+=e.zcoord},sub:function(e){this.xcoord-=e.xcoord;this.ycoord-=e.ycoord;this.zcoord-=e.zcoord},divide:function(e){this.xcoord/=e.xcoord;this.ycoord/=e.ycoord;this.zcoord/=e.zcoord},multiply:function(e){this.xcoord*=e.xcoord;this.ycoord*=e.ycoord;this.zcoord*=e.zcoord},shiftByCartesian:function(e){this.xcoord&=e.xcoord;this.ycoord&=e.ycoord;this.zcoord&=e.zcoord},subScalar:function(e){this.xcoord-=e;this.ycoord-=e;this.zcoord-=e},addScalar:function(e){this.xcoord+=e;this.ycoord+=e;this.zcoord+=e},multiplyScalar:function(e){this.xcoord*=e;this.ycoord*=e;this.zcoord*=e}};jinkeyAPI.Stage=function(){this.entityList=[];this.lightingList=[];this.userObjectList=[]};jinkeyAPI.Stage.prototype={insertEntity:function(e){this.entityList.push(e)},destroyEntity:function(e){var t=this.entityList.indexOf(e);if(t!==-1){this.entityList.splice(t,1)}return this},insertLight:function(e){this.lightingList.push(e)},destroyLight:function(e){var t=this.lightingList.indexOf(e);if(t!==-1){this.lightingList.splice(t,1)}return this}};jinkeyAPI.Display=function(){function e(e,t){this.__height=e||600;this.__width=t||800;return this}this.dpi=1;this.fullscreen=false;Object.defineProperties(this,{resolution:{writable:false,value:new e}})};jinkeyAPI.Display.prototype={prototype:jinkeyAPI.Display,setResolution:function(e,n,r){var i=this.resolution;i.__height=this.height=n||600;i.__width=this.width=e||800;this.fullscreen=r===t?false:r;return this}};jinkeyAPI.Blitter=function(){function u(e,t){if(e>=0&&t>=0&&e<n&&t<r)return true;return false}function a(e){t.save();t.translate(e.transform.xcoord,e.transform.ycoord);e.sprite.render(t);t.restore()}var e=i.createElement("canvas"),t=e.getContext("2d"),n=e.width,r=e.height,s=new jinkeyAPI.Display,o;e.id="ahoy";i.body.appendChild(e);window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,0)};this.blit=function(e,t){var n=t.entityList;for(var r=0,i=n.length;r<i;r++){var s=n[r];if(s.isVisible===false)continue;if(s instanceof jinkeyAPI.game.Entity){a(s)}}};this.refresh=function(){t.clearRect(0,0,n,r)}};jinkeyAPI.Loader=function(){function i(e){if(e instanceof Array){e.forEach(function(e){s(e)})}else{s(e)}}function s(n){if(e[n]){return e[n]}else{var i=new Image;i.onload=function(){e[n]=i;if(u()){r.forEach(function(e){e()})}};e[n]=false;i.src=n;if(i==t)alert("Error loading image")}}function o(t){return e[t]}function u(){var t=true;for(var n in e){if(e.hasOwnProperty(n)&&!e[n]){t=false}}return t}function a(e){r.push(e)}var e={};var n=[];var r=[];jinkeyAPI.resources={loadResource:i,getResource:o,isFinished:u,onComplete:a}};jinkeyAPI.Loader();jinkeyAPI.game={};jinkeyAPI.game.Sprite=function(e,t,n,r,i,s,o){this.pos=t||new jinkey.CartesianCoord(0,0,0);this.size=n;this.speed=typeof r==="number"?r:0;this.frames=i;this._index=0;this.url=e;this.dir=s||"horizontal";this.animateOnce=o;this.life=0};jinkeyAPI.game.Sprite.prototype={update:function(e){this._index+=this.speed*e;this.life+=1},render:function(e){var t;if(this.speed>0){var n=this.frames.length;var r=Math.floor(this._index);t=this.frames[r%n];if(this.animateOnce&&r>=n){this.done=true;return}}else{t=0}var i=this.pos.xcoord>>0;var s=this.pos.ycoord>>0;if(this.dir=="vertical"){s+=t*this.size.ycoord}else{i+=t*this.size.xcoord}e.drawImage(jinkeyAPI.resources.getResource(this.url),i,s,this.size.xcoord,this.size.ycoord,0,0,this.size.xcoord,this.size.ycoord)}};jinkeyAPI.game.collision=function(e,t,n,r,i,s,o,u){return!(n<=i||e>o||r<=s||t>u)};jinkeyAPI.game.boxCollision=function(e,t,n,r){return jinkeyAPI.game.collision(e.xcoord,e.ycoord,e.xcoord+t.xcoord,e.ycoord+t.ycoord,n.xcoord,n.ycoord,n.xcoord+r.xcoord,n.ycoord+r.ycoord)};jinkeyAPI.game.Entity=function(e,t,n,r,i){this.transform=e;this.sprite=t;this.physical=n||new jinkeyAPI.game.Physical;this.isNewtonian=r||true;this.isVisible=i||true};jinkeyAPI.game.Entity.prototype={constructor:jinkeyAPI.game.Entity};jinkeyAPI.game.Physical=function(e,t,n,r){this.velocity=new jinkeyAPI.CartesianCoord(0,0,0);this.acceleration=e||.005;this.maxVelocity=t||10;this.e=n||.7;this.friction=r||.8};jinkeyAPI.game.Physical.prototype={constructor:jinkeyAPI.game.Entity,update:function(){this.velocity.ycoord+=(this.maxVelocity-this.velocity.ycoord)*this.acceleration}};jinkeyAPI.game.loop=function(e){function t(){e();requestAnimationFrame(t)}requestAnimationFrame(t)}})(this)